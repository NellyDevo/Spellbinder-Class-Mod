//Battle Magic

new entry "SPELLBINDER_EXTRA_ATTACK"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hea41c9488817422db58afc31e0a3d8270c3f"
data "Description" "h2ab36720104745e0a4c5f2895752c6951240"
data "Icon" "PassiveFeature_ExtraAttack"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "20"
data "TickType" "StartTurn"
data "Boosts" "UnlockSpellVariant((ExtraAttackCheck() or ArrowOfForceCheck()),ModifyUseCosts(Replace,ActionPoint,0,0,ActionPoint),ModifyIconGlow(),ModifyTooltipDescription())"
data "RemoveConditions" "(ExtraAttackSpellCheck() or ArrowOfForceCheck()) and HasUseCosts('ActionPoint',false,context.Target) and not IsOffHandAttack()"
data "RemoveEvents" "OnSpellCast"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_EXTRA_ATTACK_Q"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h82d1a58ag3cd7g4528g80a3g9102cfba345a;1"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "10"
data "TickType" "EndTurn"
data "RemoveConditions" "not HasHigherPriorityExtraAttackQueued('SPELLBINDER_EXTRA_ATTACK_Q') and not HasAnyExtraAttack() and not HasBattleMagic()"
data "RemoveEvents" "OnStatusRemoved"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Condition)):ApplyStatus(SPELLBINDER_EXTRA_ATTACK,100,1)"

new entry "SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hea41c9488817422db58afc31e0a3d8270c3f"
data "Description" "h2ab36720104745e0a4c5f2895752c6951240"
data "Icon" "Spellbinder_Battle_Magic"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "20"
data "TickType" "StartTurn"
data "Boosts" "UnlockSpellVariant((ExtraAttackCheck() or IsCantrip()),ModifyUseCosts(Replace,ActionPoint,0,0,ActionPoint),ModifyIconGlow(),ModifyTooltipDescription())"
data "RemoveConditions" "(ExtraAttackSpellCheck() or IsCantrip()) and HasUseCosts('ActionPoint',false,context.Target) and not IsOffHandAttack()"
data "RemoveEvents" "OnSpellCast"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_Q"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h82d1a58ag3cd7g4528g80a3g9102cfba345a;1"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "10"
data "TickType" "EndTurn"
data "RemoveConditions" "not HasHigherPriorityExtraAttackQueued('SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_Q') and not HasAnyExtraAttack() and not HasBattleMagic()"
data "RemoveEvents" "OnStatusRemoved"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Condition)):ApplyStatus(SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP,100,1)"

new entry "SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_OR_FORCE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hea41c9488817422db58afc31e0a3d8270c3f"
data "Description" "h2ab36720104745e0a4c5f2895752c6951240"
data "Icon" "Spellbinder_Battle_Magic"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "20"
data "TickType" "StartTurn"
data "Boosts" "UnlockSpellVariant((ExtraAttackCheck() or IsCantrip() or ArrowOfForceCheck()),ModifyUseCosts(Replace,ActionPoint,0,0,ActionPoint),ModifyIconGlow(),ModifyTooltipDescription())"
data "RemoveConditions" "(ExtraAttackSpellCheck() or IsCantrip() or ArrowOfForceCheck()) and HasUseCosts('ActionPoint',false,context.Target) and not IsOffHandAttack()"
data "RemoveEvents" "OnSpellCast"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_OR_FORCE_Q"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h82d1a58ag3cd7g4528g80a3g9102cfba345a;1"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "10"
data "TickType" "EndTurn"
data "RemoveConditions" "not HasHigherPriorityExtraAttackQueued('SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_OR_FORCE_Q') and not HasAnyExtraAttack() and not HasBattleMagic()"
data "RemoveEvents" "OnStatusRemoved"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Condition)):ApplyStatus(SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_OR_FORCE,100,1)"


//Runic Beacon

new entry "SPELLBINDER_RUNIC_BEACON"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h94e6a0948c02455f8418a180dd2e72bbca8d"
data "Description" "h3e0adb3eae66484a9bb3270579585387768d"
data "Icon" "Spellbinder_Runic_Beacon"
data "StackId" "SPELLBINDER_RUNIC_BEACON"
data "StackPriority" "20"
data "TickType" "StartTurn"
data "Boosts" "SourceAdvantageOnAttack()"
data "RemoveEvents" "OnTurn"
data "RemoveConditions" "SavingThrow(Ability.Intelligence, SourceSpellDC(10,context.Source,Ability.Intelligence))"

new entry "SPELLBINDER_RUNIC_BEACON_UPCASTING_STATUS"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "SPELLBINDER_RUNIC_BEACON_UPCASTING"
data "StackPriority" "20"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "Passives" "Spellbinder_RunicBeacon_Upcasting_Passive_2;Spellbinder_RunicBeacon_Upcasting_Passive_3;Spellbinder_RunicBeacon_Upcasting_Passive_4;Spellbinder_RunicBeacon_Upcasting_Passive_5;Spellbinder_RunicBeacon_Upcasting_Passive_6;Spellbinder_RunicBeacon_Upcasting_Passive_7;Spellbinder_RunicBeacon_Upcasting_Passive_8;Spellbinder_RunicBeacon_Upcasting_Passive_9"
data "StatusGroups" "SG_RemoveOnRespec"

//container status for "status group" script function
new entry "STATUS_SPELLBINDER_BOUND_SPELL_REMOVER"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "SPELLBINDER_BOUND_SPELL_REMOVER"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "SPELLBINDER_WEAPON_REMOVAL_MARKER"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "SPELLBINDER_BOUND_SPELL_REMOVER_MARKER"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "STATUS_SPELLBINDER_BOUND_ARMOR_REMOVER"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "SPELLBINDER_BOUND_ARMOR_REMOVER"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

//helper status for offhand spell binding
new entry "SPELLBINDER_OFFHAND_BINDING"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "SPELLBINDER_QUICK_BINDING"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "Boosts" "UnlockSpellVariant(CanQuickBind() and IsCantrip(),ModifyUseCosts(Replace,BonusActionPoint,1,0,ActionPoint),ModifyUseCosts(Add,QuickBindPoint,1,0),ModifyIconGlow())"

new entry "SPELLBINDER_RESIDUAL_MAGIC"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"
data "StackId" "SPELLBINDER_BOUND_ARMOR"
data "Boosts" "AC(1)"
data "Icon" "Spellbinder_Bind_Armor"
data "StatusGroups" "SG_RemoveOnRespec"
data "DisplayName" "hbacfba5025ab4c508f981a5bcb38b1aa929b"
data "Description" "hdad94a2c5fa8412eb46e0a2dc865dd1946f5"
data "StackType" "Overwrite"

//helper status for spectral arrows
new entry "SPELLBINDER_SPECTRAL_ARROWS"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

//helper status for runic beacon on last-charge weapon attacks
new entry "SPELLBINDER_RECENTLY_BOUND"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "Boosts" "Tag(SPELLBINDER_BOUND)"

new entry "SPELLBINDER_LOOP_STOPPER"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "SPELLBINDER_TELEKINETIC_PROJECTILES_MARKER"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h57c9228bffcf41c395ee6af163c9d9a5c70g"
data "Description" "h98f68b6c0bd54e6bb5c667fbd08826b210c0"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "Boosts" "UnlockSpellVariant(BoundRangedSpellCheck(),ModifyTargetRadius(Multiplicative,1.5),ModifyIconGlow(),ModifyTooltipDescription());UnlockSpellVariant(BoundRangedOffHandSpellCheck(),ModifyTargetRadius(Multiplicative,1.5),ModifyIconGlow(),ModifyTooltipDescription())"

new entry "SPELLBINDER_SPELL_DANCER_MAGICAL_ARC"
type "StatusData"
data "StatusType" "BOOST"
data "OnApplyFunctors" "IF(not ClassLevelHigherOrEqualThan(11,'Spellbinder')):ApplyStatus(SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_1,100,1);IF(ClassLevelHigherOrEqualThan(11,'Spellbinder') and not ClassLevelHigherOrEqualThan(15,'Spellbinder')):ApplyStatus(SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_2,100,1);IF(ClassLevelHigherOrEqualThan(15,'Spellbinder')):ApplyStatus(SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_3,100,1)"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_1"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "haedb89a68428476589d3bde6d33aa08838gd"
data "Description" "h475e3a2cbcde40a2a977804e49323d747073"
data "Icon" "Spellbinder_Magical_Arc"
data "DescriptionParams" "1"
data "Passives" "Spellbinder_SpellDancer_MagicalArc"

new entry "SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_2"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_1"
data "DescriptionParams" "2"
data "Passives" "Spellbinder_SpellDancer_MagicalArc_2"

new entry "SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_3"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_SPELL_DANCER_MAGICAL_ARC_1"
data "DescriptionParams" "3"
data "Passives" "Spellbinder_SpellDancer_MagicalArc_3"

new entry "SPELLBINDER_MAGICAL_WELLSPRING_COOLDOWN"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "IgnoreResting;DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead"

new entry "SPELLBINDER_MYSTIC_DICE"
type "StatusData"
data "StatusType" "BOOST"
data "Boosts" "ActionResource(MysticDie,2,0)"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "SPELLBINDER_MYSTIC_DICE_2"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_MYSTIC_DICE"
data "Boosts" "ActionResource(MysticDie,1,0)"

new entry "SPELLBINDER_MYSTIC_DICE_3"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_MYSTIC_DICE_2"

new entry "SPELLBINDER_MYSTIC_DICE_4"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_MYSTIC_DICE_2"

new entry "SPELLBINDER_MYSTIC_DICE_5"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_MYSTIC_DICE_2"

new entry "SPELLBINDER_REWEAVE"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "IgnoreResting;DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "SPELLBINDER_REWEAVE_SPEND"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "OnApplyFunctors" "UseActionResource(ReweavePoint,1)"

new entry "SPELLBINDER_SPECTRAL_ARROWS_SPEND"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "OnApplyFunctors" "UseActionResource(SpectralArrowPoint,1)"

new entry "SPELLBINDER_SPELLSWORD"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hed20898c073e4784814f0ad2b66ae6fd2ad0"
data "Description" "hf887d44c412b416293014a19da42aa28a3a8"
data "Icon" "Spellbinder_Spellsword"
data "Boosts" "RollBonus(MeleeWeaponAttack,2);RollBonus(MeleeOffHandWeaponAttack,2);RollBonus(RangedWeaponAttack,2);RollBonus(RangedOffHandWeaponAttack,2)"

new entry "SPELLBINDER_ARROW_OF_FORCE"
type "StatusData"
data "StatusType" "BOOST"
data "Boosts" "ActionResource(ArrowOfForcePoint,2,0)"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "SPELLBINDER_ARROW_OF_FORCE_2"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_ARROW_OF_FORCE"
data "Boosts" "ActionResource(ArrowOfForcePoint,1,0)"

new entry "SPELLBINDER_ARROW_OF_FORCE_3"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_ARROW_OF_FORCE_2"

new entry "SPELLBINDER_ARROW_OF_FORCE_4"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_ARROW_OF_FORCE_2"

new entry "SPELLBINDER_ARROW_OF_FORCE_5"
type "StatusData"
data "StatusType" "BOOST"
using "SPELLBINDER_ARROW_OF_FORCE_2"

new entry "SPELLBINDER_MYSTIC_DICE_RESTORE"
type "StatusData"
data "StatusType" "BOOST"
data "OnRemoveFunctors" "RestoreResource(MysticDie,1,0)"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_RUNIC_BEACON_CASTER"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "RemoveEvents" "OnSpellCast"
data "RemoveConditions" "not HasUseCosts('FauxTagIsBoundSpell')"
data "OnRemoveFunctors" "ApplyStatus(SPELLBINDER_RUNIC_BEACON_CLEANUP,100,0)"
data "Boosts" "UnlockSpell(Projectile_Spellbinder_RunicBeacon,AddChildren,d136c5d9-0ff0-43da-ceac-4aa7f807bfd6)"
data "StackType" "Overwrite"

new entry "SPELLBINDER_RUNIC_BEACON_TARGET"
type "StatusData"
data "StatusType" "BOOST"
data "Icon" "Spellbinder_Runic_Beacon"
data "DisplayName" "h1b5d239522ea44f6a4ae16445775bc7bd2gc"
data "Description" "h15e2ffa887b9469c95b5e2d63e3cdb3fda73"
data "RemoveEvents" "OnSourceStatusApplied"
data "RemoveConditions" "not HasStatus('SPELLBINDER_RUNIC_BEACON_CASTER', context.Source)"
data "StackType" "Overwrite"

new entry "SPELLBINDER_RUNIC_BEACON_CLEANUP"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "SPELLBINDER_SPELLDANCER_BATTLE_DANCE_APPLIER"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_SPELLDANCER_BATTLE_DANCE_TRACKER"
type "StatusData"
data "StatusType" "BOOST"
data "RemoveEvents" "OnTurn"
data "Passives" "Spellbinder_SpellDancer_BattleDance_Tracker_Passive"
data "StatusPropertyFlags" "FreezeDuration"
data "StackType" "Ignore"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_SPELLDANCER_BATTLE_DANCE"
type "StatusData"
data "StatusType" "BOOST"
data "Boosts" "IgnoreLeaveAttackRange();ActionResource(Movement,3,0)"
data "DisplayName" "hd08f9d660e974a92be8a75e65bdb222ee6f9"
data "Description" "h1af7b610ca5a4bd48e462dec69cc2595a4ae"
data "DescriptionParams" "Distance(3)"
data "Icon" "Spellbinder_Battle_Dance"
data "RemoveEvents" "OnTurn"
data "StatusPropertyFlags" "MultiplyEffectsByDuration;FreezeDuration"
data "TickType" "EndTurn"
data "StackType" "Stack"

new entry "SPELLBINDER_SPELLDANCER_BATTLE_DANCE_MOVE_TRIGGER"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

//Arcane Smite

new entry "SPELLBINDER_EXTRA_ATTACK_ARCANE_SMITE_Q"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h9857b3b0g7582g48c9g95bdg6c96e2a2afcb;1"
data "TickType" "StartTurn"
data "RemoveConditions" "not RemoveCause(StatusRemoveCause.TimeOut) and (not IsStatusEvent(StatusEvent.OnSpellCast) and not HasHigherPriorityExtraAttackQueued('EXTRA_ATTACK_ARCANE_SMITE_Q') and not HasAnyExtraAttack() and not HasBattleMagic() and not HasStatus('SPELLBINDER_EXTRA_ATTACK_ARCANE_SMITE', context.Source)) or (IsStatusEvent(StatusEvent.OnSpellCast) and (not HasActionResource('BonusActionPoint', 1, 0, false, false) or not HasActionResource('ArcaneSmitePoint', 1, 0, false, false)))"
data "RemoveEvents" "OnStatusRemoved"
data "StackId" "SPELLBINDER_EXTRA_ATTACK_ARCANE_SMITE"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Condition) and HasActionResource('BonusActionPoint', 1, 0, false, false) and HasActionResource('ArcaneSmitePoint', 1, 0, false, false)):ApplyStatus(EXTRA_ATTACK_ARCANE_SMITE, 100, 1)"

new entry "SPELLBINDER_EXTRA_ATTACK_ARCANE_SMITE"
type "StatusData"
data "StatusType" "BOOST"
using "EXTRA_ATTACK"
data "DisplayName" "hb662f26a38e640c79b24e3b66a880902baa6"
data "Description" "hc7e06767974642a38ce440715f970907412d"
data "Icon" "Spellbinder_Reweave"
data "StackId" "SPELLBINDER_EXTRA_ATTACK_ARCANE_SMITE"
data "Boosts" "UnlockSpellVariant(ExtraAttackCheck(),ModifyUseCosts(Replace,BonusActionPoint,1,0,ActionPoint),ModifyUseCosts(Add,ArcaneSmitePoint,1,0),ModifyIconGlow(),ModifyTooltipDescription())"
data "RemoveConditions" "((HasStringInSpellRoll('WeaponAttack') or HasStringInSpellRoll('UnarmedAttack') or SpellId('Target_CommandersStrike')) and HasUseCosts('ActionPoint') and not IsOffHandAttack()) or not HasActionResource('BonusActionPoint', 1, 0, false, false) or not HasActionResource('ArcaneSmitePoint', 1, 0, false, false)"