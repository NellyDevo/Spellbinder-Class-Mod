//Battle Magic

new entry "SPELLBINDER_EXTRA_ATTACK"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hea41c9488817422db58afc31e0a3d8270c3f"
data "Description" "h2ab36720104745e0a4c5f2895752c6951240"
data "Icon" "PassiveFeature_ExtraAttack"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "20"
data "TickType" "StartTurn"
data "Boosts" "UnlockSpellVariant(ExtraAttackCheck(),ModifyUseCosts(Replace,ActionPoint,0,0,ActionPoint),ModifyIconGlow(),ModifyTooltipDescription())"
data "RemoveConditions" "ExtraAttackSpellCheck() and HasUseCosts('ActionPoint',false,context.Target) and not IsOffHandAttack()"
data "RemoveEvents" "OnSpellCast"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_EXTRA_ATTACK_Q"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h82d1a58ag3cd7g4528g80a3g9102cfba345a;1"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "10"
data "TickType" "EndTurn"
data "RemoveConditions" "not HasHigherPriorityExtraAttackQueued('SPELLBINDER_EXTRA_ATTACK_Q') and not HasAnyExtraAttack() and not HasBattleMagic()"
data "RemoveEvents" "OnStatusRemoved"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Condition)):ApplyStatus(SPELLBINDER_EXTRA_ATTACK,100,1)"

new entry "SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hea41c9488817422db58afc31e0a3d8270c3f"
data "Description" "h2ab36720104745e0a4c5f2895752c6951240"
data "Icon" "Spellbinder_Battle_Magic"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "20"
data "TickType" "StartTurn"
data "Boosts" "UnlockSpellVariant((ExtraAttackCheck() or IsCantrip()),ModifyUseCosts(Replace,ActionPoint,0,0,ActionPoint),ModifyIconGlow(),ModifyTooltipDescription())"
data "RemoveConditions" "(ExtraAttackSpellCheck() or IsCantrip()) and HasUseCosts('ActionPoint',false,context.Target) and not IsOffHandAttack()"
data "RemoveEvents" "OnSpellCast"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"

new entry "SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_Q"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h82d1a58ag3cd7g4528g80a3g9102cfba345a;1"
data "StackId" "SPELLBINDER_EXTRA_ATTACK"
data "StackPriority" "10"
data "TickType" "EndTurn"
data "RemoveConditions" "not HasHigherPriorityExtraAttackQueued('SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP_Q') and not HasAnyExtraAttack() and not HasBattleMagic()"
data "RemoveEvents" "OnStatusRemoved"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Condition)):ApplyStatus(SPELLBINDER_EXTRA_ATTACK_OR_CANTRIP,100,1)"

//Runic Beacon

new entry "SPELLBINDER_RUNIC_BEACON"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h94e6a0948c02455f8418a180dd2e72bbca8d"
data "Description" "h3e0adb3eae66484a9bb3270579585387768d"
data "Icon" "Spellbinder_Runic_Beacon"
data "StackId" "SPELLBINDER_RUNIC_BEACON"
data "StackPriority" "20"
data "TickType" "StartTurn"
data "Boosts" "SourceAdvantageOnAttack()"
data "RemoveEvents" "OnTurn"
data "RemoveConditions" "SavingThrow(Ability.Intelligence, SourceSpellDC(10,context.Source,Ability.Intelligence))"

new entry "SPELLBINDER_RUNIC_BEACON_UPCASTING_STATUS"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "SPELLBINDER_RUNIC_BEACON_UPCASTING"
data "StackPriority" "20"
data "StatusPropertyFlags" "IgnoreResting;DisableCombatlog;DisablePortraitIndicator;DisableOverhead;ApplyToDead"
data "Passives" "Spellbinder_RunicBeacon_Upcasting_Passive_2;Spellbinder_RunicBeacon_Upcasting_Passive_3;Spellbinder_RunicBeacon_Upcasting_Passive_4;Spellbinder_RunicBeacon_Upcasting_Passive_5;Spellbinder_RunicBeacon_Upcasting_Passive_6;Spellbinder_RunicBeacon_Upcasting_Passive_7;Spellbinder_RunicBeacon_Upcasting_Passive_8;Spellbinder_RunicBeacon_Upcasting_Passive_9"
data "StatusGroups" "SG_RemoveOnRespec"

//container status for "status group" script function
new entry "STATUS_SPELLBINDER_BOUND_SPELL_REMOVER"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "SPELLBINDER_BOUND_SPELL_REMOVER"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "STATUS_SPELLBINDER_BOUND_ARMOR_REMOVER"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "SPELLBINDER_BOUND_ARMOR_REMOVER"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

//helper status for offhand spell binding
new entry "SPELLBINDER_OFFHAND_BINDING"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "SPELLBINDER_QUICK_BINDING"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "Boosts" "UnlockSpellVariant(CanQuickBind() and IsCantrip(),ModifyUseCosts(Replace,BonusActionPoint,1,0,ActionPoint),ModifyUseCosts(Add,QuickBindPoint,1,0),ModifyIconGlow());UnlockSpellVariant(CanQuickBind() and not IsCantrip(),ModifyUseCosts(Replace,BonusActionPoint,1,0,ActionPoint),ModifyUseCosts(Add,QuickBindPoint,1,0),ModifyUseCosts(Add,QuickBindPoint,SpellPowerLevel,0),ModifyIconGlow());UnlockSpellVariant(SpellId('Spellbinder_Quick_Bind'),ModifyIconGlow())"

new entry "SPELLBINDER_RESIDUAL_MAGIC"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"
data "StackId" "SPELLBINDER_BOUND_ARMOR"
data "Boosts" "AC(1)"
data "Icon" "Spellbinder_Bind_Armor"
data "StatusGroups" "SG_RemoveOnRespec"
data "DisplayName" "hbacfba5025ab4c508f981a5bcb38b1aa929b"
data "Description" "hdad94a2c5fa8412eb46e0a2dc865dd1946f5"
data "StackType" "Overwrite"

//helper status for spectral arrows
new entry "SPELLBINDER_SPECTRAL_ARROWS"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

//helper status for runic beacon on last-charge weapon attacks
new entry "SPELLBINDER_RECENTLY_BOUND"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "Boosts" "Tag(SPELLBINDER_BOUND)"